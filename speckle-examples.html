

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Examples &#8212; Rangekeeper</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'speckle-examples';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/rangekeeper.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/rangekeeper.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Rangekeeper
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Real Estate Flexibility and Valuation under Uncertainty</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="basic_dcf.html">A Basic Discounted Cash Flow Valuation</a></li>
<li class="toctree-l1"><a class="reference internal" href="deterministic_scenarios.html">Deterministic Scenario Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="market_dynamics.html">Real Estate Pricing Factor Dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="flexibility_intro.html">Introduction to Modeling Flexibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="flexibility_under_uncertainty.html">Flexibility under Uncertainty</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Using Rangekeeper in Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="speckle.html">Loading a Design Scenario</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/daniel-fink/rangekeeper/blob/master/walkthrough/speckle-examples.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/daniel-fink/rangekeeper" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/daniel-fink/rangekeeper/issues/new?title=Issue%20on%20page%20%2Fspeckle-examples.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/speckle-examples.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Examples</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sending-receiving">Sending &amp; Receiving</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#short-hand-the-stream-wrapper">Short Hand: The Stream Wrapper</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-functionality">Overview of Functionality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graphql-client">GraphQL Client</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operations-and-transports">Operations and Transports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#base-object-serialization">Base Object &amp; Serialization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-base-object">The Base Object</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#subclassing-base">Subclassing Base</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#serialization">Serialization</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %pip install specklepy</span>

<span class="n">HOST_SERVER</span><span class="o">=</span><span class="s2">&quot;speckle.xyz&quot;</span>
<span class="n">TOKEN</span><span class="o">=</span><span class="s2">&quot;52c9b20071b2854f98ad91af10c154ad5e232b88a7&quot;</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h1>
<p>This doc will show you the basics of sending and receiving data and give you an overview of SpecklePy functionality. However, it is not comprehensive. For more examples, please explore the repo’s <a class="reference external" href="https://github.com/specklesystems/speckle-py/tree/main/tests">tests</a>.</p>
<section id="sending-receiving">
<h2>Sending &amp; Receiving<a class="headerlink" href="#sending-receiving" title="Permalink to this heading">#</a></h2>
<p>Let’s look at how to send an object to a stream on your server and then receive that object back.</p>
<p>First, you’ll need to create and authenticate a client. To use the client, you’ll need access to a Speckle server. To authenticate the client, you’ll either need local accounts (added using <span class="xref myst">Manager</span>), or you can go to <code class="docutils literal notranslate"><span class="pre">your-server.com/profile</span></code> and create a Personal Access Token.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">specklepy.api.client</span> <span class="kn">import</span> <span class="n">SpeckleClient</span>
<span class="kn">from</span> <span class="nn">specklepy.api.credentials</span> <span class="kn">import</span> <span class="n">get_default_account</span>

<span class="c1"># initialise the client</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">SpeckleClient</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">HOST_SERVER</span><span class="p">)</span> <span class="c1"># or whatever your host is</span>
<span class="c1"># client = SpeckleClient(host=&quot;localhost:3000&quot;, use_ssl=False) or use local server</span>

<span class="c1"># authenticate the client with a token</span>
<span class="n">account</span> <span class="o">=</span> <span class="n">get_default_account</span><span class="p">()</span>
<span class="n">client</span><span class="o">.</span><span class="n">authenticate_with_account</span><span class="p">(</span><span class="n">account</span><span class="p">)</span>

<span class="c1"># if you&#39;re in an environment without accounts, you can construct an Account object yourself</span>
<span class="c1"># or authenticate with just a token</span>
<span class="c1">#client.authenticate_with_token(TOKEN)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that you have an authenticated client, you can start interacting with the API. Let’s create a new stream and get that stream back.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a new stream. this returns the stream id</span>
<span class="n">new_stream_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;a shiny new stream&quot;</span><span class="p">)</span>

<span class="c1"># use that stream id to get the stream from the server</span>
<span class="n">new_stream</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">new_stream_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we’ll need some data to send. Let’s extend <code class="docutils literal notranslate"><span class="pre">Base</span></code> to create a simple block to make it more interesting. All your custom objects should inherit from <code class="docutils literal notranslate"><span class="pre">Base</span></code> to ensure that serialization will work as expected.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">specklepy.objects</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">from</span> <span class="nn">specklepy.objects.geometry</span> <span class="kn">import</span> <span class="n">Point</span>

<span class="k">class</span> <span class="nc">Block</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">length</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">height</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">origin</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">Point</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="c1"># mark the origin as a detachable attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_detachable_attrs</span><span class="p">({</span><span class="s2">&quot;origin&quot;</span><span class="p">})</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="n">origin</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s send a block to the server! To do this, you’ll first need to send the object to the stream and get back the object id or hash. You can then use this to create a commit on the stream that references this object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">specklepy.transports.server</span> <span class="kn">import</span> <span class="n">ServerTransport</span>
<span class="kn">from</span> <span class="nn">specklepy.api</span> <span class="kn">import</span> <span class="n">operations</span>

<span class="c1"># here&#39;s the data you want to send</span>
<span class="n">block</span> <span class="o">=</span> <span class="n">Block</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># next create a server transport - this is the vehicle through which you will send and receive</span>
<span class="n">transport</span> <span class="o">=</span> <span class="n">ServerTransport</span><span class="p">(</span><span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">,</span> <span class="n">stream_id</span><span class="o">=</span><span class="n">new_stream_id</span><span class="p">)</span>

<span class="c1"># this serialises the block and sends it to the transport</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="n">operations</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="n">block</span><span class="p">,</span> <span class="n">transports</span><span class="o">=</span><span class="p">[</span><span class="n">transport</span><span class="p">])</span>

<span class="c1"># you can now create a commit on your stream with this object</span>
<span class="n">commid_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">commit</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">stream_id</span><span class="o">=</span><span class="n">new_stream_id</span><span class="p">,</span> 
    <span class="n">object_id</span><span class="o">=</span><span class="nb">hash</span><span class="p">,</span> 
    <span class="n">message</span><span class="o">=</span><span class="s2">&quot;this is a block I made in speckle-py&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Tada! You should now have a commit on your stream containing your block. You’ll be able to see the commit on the stream page on the web. Receiving an object back is pretty similar to receiving it. You’ll generally be using the client to get a commit, then getting the hash to receive from the <code class="docutils literal notranslate"><span class="pre">referencedObject</span></code> attribute on that commit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this receives the object back from the transport.</span>
<span class="c1"># the received data will be deserialised back into a `Block` </span>
<span class="n">received_base</span> <span class="o">=</span> <span class="n">operations</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">obj_id</span><span class="o">=</span><span class="nb">hash</span><span class="p">,</span> <span class="n">remote_transport</span><span class="o">=</span><span class="n">transport</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="short-hand-the-stream-wrapper">
<h3>Short Hand: The Stream Wrapper<a class="headerlink" href="#short-hand-the-stream-wrapper" title="Permalink to this heading">#</a></h3>
<p>You’ve just seen how to simply send and receive objects using the <code class="docutils literal notranslate"><span class="pre">SpeckleClient</span></code> and a <code class="docutils literal notranslate"><span class="pre">ServerTransport</span></code>. Since v2.2.6, you can use a handy helper to get a client and a transport from a stream URL - the <code class="docutils literal notranslate"><span class="pre">StreamWrapper</span></code>!</p>
<p>The <code class="docutils literal notranslate"><span class="pre">StreamWrapper</span></code> can parse any URL pointing to a stream, branch, commit, object, or globals. If you have a local account for the stream you provided, you can get an authenticated client and transport using the helper methods:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">specklepy.api.wrapper</span> <span class="kn">import</span> <span class="n">StreamWrapper</span>

<span class="c1"># provide any stream, branch, commit, object, or globals url</span>
<span class="n">wrapper</span> <span class="o">=</span> <span class="n">StreamWrapper</span><span class="p">(</span><span class="s2">&quot;https://speckle.xyz/streams/3073b96e86/commits/604bea8cc6&quot;</span><span class="p">)</span>

<span class="c1"># get an authenticated SpeckleClient if you have a local account for the server</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">get_client</span><span class="p">()</span>

<span class="c1"># get an authenticated ServerTransport if you have a local account for the server</span>
<span class="n">transport</span> <span class="o">=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">get_transport</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="overview-of-functionality">
<h2>Overview of Functionality<a class="headerlink" href="#overview-of-functionality" title="Permalink to this heading">#</a></h2>
<section id="graphql-client">
<h3>GraphQL Client<a class="headerlink" href="#graphql-client" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">SpeckleClient</span></code> is the entry point for interacting with the GraphQL API. You’ll need to have access to a speckle server to use this. To authenticate, you’ll need a token. You can either get one from an account you’ve already added to your computer using the <span class="xref myst">Manager</span>, or you can head to <code class="docutils literal notranslate"><span class="pre">your-server.com/profile</span></code> and create a Personal Access Token.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">specklepy.api.client</span> <span class="kn">import</span> <span class="n">SpeckleClient</span>
<span class="kn">from</span> <span class="nn">specklepy.api.credentials</span> <span class="kn">import</span> <span class="n">get_default_account</span><span class="p">,</span> <span class="n">get_local_accounts</span>

<span class="n">all_accounts</span> <span class="o">=</span> <span class="n">get_local_accounts</span><span class="p">()</span> <span class="c1"># get back a list</span>
<span class="n">account</span> <span class="o">=</span> <span class="n">get_default_account</span><span class="p">()</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">SpeckleClient</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;your-server.com&quot;</span><span class="p">)</span> <span class="c1"># or whatever your host is</span>
<span class="c1"># client = SpeckleClient(host=&quot;localhost:3000&quot;, use_ssl=False) or use local server</span>

<span class="n">client</span><span class="o">.</span><span class="n">authenticate_with_account</span><span class="p">(</span><span class="n">account</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">SpeckleException</span><span class="g g-Whitespace">                          </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">line</span> <span class="mi">10</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">client</span> <span class="o">=</span> <span class="n">SpeckleClient</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;your-server.com&quot;</span><span class="p">)</span> <span class="c1"># or whatever your host is</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="c1"># client = SpeckleClient(host=&quot;localhost:3000&quot;, use_ssl=False) or use local server</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="n">client</span><span class="o">.</span><span class="n">authenticate_with_account</span><span class="p">(</span><span class="n">account</span><span class="p">)</span>

<span class="nn">File ~/Library/Caches/pypoetry/virtualenvs/rangekeeper-f3dfj9iv-py3.10/lib/python3.10/site-packages/specklepy/api/client.py:146,</span> in <span class="ni">SpeckleClient.authenticate_with_account</span><span class="nt">(self, account)</span>
<span class="g g-Whitespace">    </span><span class="mi">144</span> <span class="n">metrics</span><span class="o">.</span><span class="n">track</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">CLIENT</span><span class="p">,</span> <span class="n">account</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;authenticate with account&quot;</span><span class="p">})</span>
<span class="g g-Whitespace">    </span><span class="mi">145</span> <span class="bp">self</span><span class="o">.</span><span class="n">account</span> <span class="o">=</span> <span class="n">account</span>
<span class="ne">--&gt; </span><span class="mi">146</span> <span class="bp">self</span><span class="o">.</span><span class="n">_set_up_client</span><span class="p">()</span>

<span class="nn">File ~/Library/Caches/pypoetry/virtualenvs/rangekeeper-f3dfj9iv-py3.10/lib/python3.10/site-packages/specklepy/api/client.py:174,</span> in <span class="ni">SpeckleClient._set_up_client</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">172</span>             <span class="k">raise</span> <span class="n">user_or_error</span><span class="o">.</span><span class="n">exception</span>
<span class="g g-Whitespace">    </span><span class="mi">173</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">174</span>             <span class="k">raise</span> <span class="n">user_or_error</span>
<span class="g g-Whitespace">    </span><span class="mi">175</span> <span class="k">except</span> <span class="n">TransportServerError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">176</span>     <span class="k">if</span> <span class="n">ex</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>

<span class="ne">SpeckleException</span>: SpeckleException: Failed to execute the GraphQL active_user request. Inner exception: Server did not return a GraphQL result: Not a JSON answer: &lt;html&gt;&lt;head&gt;&lt;title&gt;your-server.com&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;your-server.com&lt;/h1&gt;&lt;p&gt;Coming soon.&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</pre></div>
</div>
</div>
</div>
<p>Interacting with streams is designed to be intuitive and evocative of SpecklePy 1.0</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get a list of your most recent streams</span>
<span class="n">stream_list</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>

<span class="c1"># search your streams</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;mech&quot;</span><span class="p">)</span>

<span class="c1"># create a stream</span>
<span class="n">new_stream_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;a shiny new stream&quot;</span><span class="p">)</span>

<span class="c1"># get a stream</span>
<span class="n">new_stream</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">new_stream_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>New in 2.0: branches and commits! Here are some basic interactions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get list of commits</span>
<span class="n">commits</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">commit</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="s2">&quot;stream_id&quot;</span><span class="p">)</span>

<span class="c1"># get a specific commit</span>
<span class="n">commit</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">commit</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;stream_id&quot;</span><span class="p">,</span> <span class="s2">&quot;commit_id&quot;</span><span class="p">)</span>

<span class="c1"># create a commit</span>
<span class="n">commit_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">commit</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">stream_id</span><span class="o">=</span><span class="s2">&quot;stream_id&quot;</span><span class="p">,</span> <span class="n">object_id</span><span class="o">=</span><span class="s2">&quot;object_id&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;this is a commit message to describe the commit&quot;</span><span class="p">)</span>

<span class="c1"># delete a commit</span>
<span class="n">deleted</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">commit</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s2">&quot;stream_id&quot;</span><span class="p">,</span> <span class="s2">&quot;commit_id&quot;</span><span class="p">)</span>

<span class="c1"># get a list of branches</span>
<span class="n">branches</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">branch</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="s2">&quot;stream_id&quot;</span><span class="p">)</span>

<span class="c1"># create a branch</span>
<span class="n">branch_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">branch</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="s2">&quot;stream_id&quot;</span><span class="p">,</span> <span class="s2">&quot;branch name&quot;</span><span class="p">,</span> <span class="s2">&quot;a description of the branch&quot;</span><span class="p">)</span>

<span class="c1"># get a specific branch</span>
<span class="n">branch</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">branch</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;stream_id&quot;</span><span class="p">,</span> <span class="s2">&quot;branch name&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="operations-and-transports">
<h3>Operations and Transports<a class="headerlink" href="#operations-and-transports" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">operations</span></code> include four main methods:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">send</span></code>: send an object to a stream</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">receive</span></code>: receive an object from a stream</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">serialize</span></code>: serialize a given <code class="docutils literal notranslate"><span class="pre">Base</span></code> object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">deserialize</span></code>: deserializes JSON into an object into the type specified in <code class="docutils literal notranslate"><span class="pre">speckle_type</span></code> (defaults to a vanilla <code class="docutils literal notranslate"><span class="pre">Base</span></code> if the type can’t be found)</p></li>
</ol>
<p>Let’s look at sending and receiving. You will need to provide a <code class="docutils literal notranslate"><span class="pre">transport</span></code> to indicate where the objects should be sent to/received from. When sending, you can provide multiple transports to send the same object to multiple places simultaneously. Currently, we have three types of ‘transport’: <code class="docutils literal notranslate"><span class="pre">SQLiteTransport</span></code>, <code class="docutils literal notranslate"><span class="pre">MemoryTransport</span></code>, and <code class="docutils literal notranslate"><span class="pre">ServerTransport</span></code>. If you’d like to learn more about Transports in Speckle 2.0, have a look <span class="xref myst">here</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">specklepy.transports.memory</span> <span class="kn">import</span> <span class="n">MemoryTransport</span>
<span class="kn">from</span> <span class="nn">specklepy.api</span> <span class="kn">import</span> <span class="n">operations</span>

<span class="n">transport</span> <span class="o">=</span> <span class="n">MemoryTransport</span><span class="p">()</span>
<span class="n">base_obj</span> <span class="o">=</span> <span class="n">Base</span><span class="p">()</span>

<span class="c1"># this serialises the object and sends it to the transport</span>
<span class="nb">hash</span> <span class="o">=</span> <span class="n">operations</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="n">base_obj</span><span class="p">,</span> <span class="n">transports</span><span class="o">=</span><span class="p">[</span><span class="n">transport</span><span class="p">])</span>

<span class="c1"># if the object had detached objects, you can see these as well</span>
<span class="n">saved_objects</span> <span class="o">=</span> <span class="n">transport</span><span class="o">.</span><span class="n">objects</span> <span class="c1"># a dict with the obj hash as the key</span>

<span class="c1"># this receives an object from the given transport, deserialises it,</span>
<span class="c1"># and recomposes it into a base object.</span>
<span class="c1"># you can optionally provide a local_transport which will default to</span>
<span class="c1"># the `SQLiteTransport` pointing at your local cache</span>
<span class="n">received_base</span> <span class="o">=</span> <span class="n">operations</span><span class="o">.</span><span class="n">receive</span><span class="p">(</span><span class="n">obj_id</span><span class="o">=</span><span class="nb">hash</span><span class="p">,</span> <span class="n">remote_transport</span><span class="o">=</span><span class="n">transport</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/jonathonbroughton/.pyenv/versions/3.10.4/envs/jupyter-speckle/lib/python3.10/site-packages/specklepy/objects/units.py:34: SpeckleWarning: Invalid units: expected type str but received &lt;class &#39;NoneType&#39;&gt; (None). Skipping - no units will be set.
  warn(
</pre></div>
</div>
</div>
</div>
<p>You can also use the GraphQL API to send and receive objects. However, note that this method will not recompose a base and will only get the object you explicitly ask for using by its id.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">specklepy.objects</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">from</span> <span class="nn">specklepy.serialization.base_object_serializer</span> <span class="kn">import</span> <span class="n">BaseObjectSerializer</span>

<span class="c1"># create a test base object</span>
<span class="n">test_base</span> <span class="o">=</span> <span class="n">Base</span><span class="p">()</span>
<span class="n">test_base</span><span class="o">.</span><span class="n">testing</span> <span class="o">=</span> <span class="s2">&quot;a test base obj&quot;</span>

<span class="c1"># run it through the serialiser</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">BaseObjectSerializer</span><span class="p">()</span>
<span class="nb">hash</span><span class="p">,</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">traverse_base</span><span class="p">(</span><span class="n">test_base</span><span class="p">)</span>

<span class="c1"># send it to the server</span>
<span class="n">objCreate</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">stream_id</span><span class="o">=</span><span class="s2">&quot;stream id&quot;</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="p">[</span><span class="n">obj</span><span class="p">])</span>

<span class="n">received_base</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;stream id&quot;</span><span class="p">,</span> <span class="nb">hash</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="base-object-serialization">
<h3>Base Object &amp; Serialization<a class="headerlink" href="#base-object-serialization" title="Permalink to this heading">#</a></h3>
<section id="the-base-object">
<h4>The Base Object<a class="headerlink" href="#the-base-object" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">Base</span></code> class is the one you’re familiar with from the rest of the Speckle universe. It generally behaves the same way as it does in the other SDKs. For more info about the <code class="docutils literal notranslate"><span class="pre">Base</span></code> object, have a look <span class="xref myst">here</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">specklepy.objects</span> <span class="kn">import</span> <span class="n">Base</span>

<span class="c1"># creating a base we will nest within a parent base</span>
<span class="n">detached_base</span> <span class="o">=</span> <span class="n">Base</span><span class="p">()</span>
<span class="n">detached_base</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;a detached base&quot;</span>

<span class="c1"># creating our parent base object</span>
<span class="n">base_obj</span> <span class="o">=</span> <span class="n">Base</span><span class="p">()</span>

<span class="c1"># attributes can be added using dot or dict notation</span>
<span class="n">base_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;my base&quot;</span>
<span class="n">base_obj</span><span class="p">[</span><span class="s2">&quot;colour&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;lilac&quot;</span>

<span class="c1"># other base objects can be nested within.</span>
<span class="c1"># prepending the attribute name with `@` will detach the nested base when sending</span>
<span class="n">base_obj</span><span class="p">[</span><span class="s2">&quot;@nested&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">detached_base</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Base</span></code> class has a few handy instance methods for identifying your object’s typed and dynamic attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_typed_member_names()</span></code> gets all of the names of the defined (typed) attributes of the object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dynamic_member_names()</span></code> gets all of the names of the dynamic attributes of the object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_member_names()</span></code> gets a list of all the attributes on the object, dynamic or not</p></li>
</ul>
<p>Each <code class="docutils literal notranslate"><span class="pre">Base</span></code> object has an <code class="docutils literal notranslate"><span class="pre">id</span></code> (a unique hash) as it does in the other SDKs. This field is only populated if the <code class="docutils literal notranslate"><span class="pre">Base</span></code> has been previously serialized. If you <em>really</em> need the hash, you can get it using the <code class="docutils literal notranslate"><span class="pre">get_id()</span></code> method. Be aware that this call will fully serialize the object to create the <code class="docutils literal notranslate"><span class="pre">id</span></code> if the <code class="docutils literal notranslate"><span class="pre">id</span></code> is not populated! By default, the hash will be generated without decomposing the object. However, you can pass <code class="docutils literal notranslate"><span class="pre">decompose=True</span></code> as an argument if you want the decomposed <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
</section>
<section id="subclassing-base">
<h4>Subclassing Base<a class="headerlink" href="#subclassing-base" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">Base</span></code> class can be subclassed to create your own custom objects. These are automatically added to a class-level registry, simply a dictionary with the type name as the key. The type is automatically populated by the <code class="docutils literal notranslate"><span class="pre">speckle_type</span></code> attribute but can be overwritten when writing your class.</p>
<p>Note that all typed attributes of a class <strong>must be initialized with a non-mutable default value</strong> or a value that you will only change by reassignment. If you’d like mutable defaults, you should write an <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method for the class to set these (see the <code class="docutils literal notranslate"><span class="pre">Block</span></code> example in the first section).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">specklepy.objects</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">from</span> <span class="nn">specklepy.objects.geometry</span> <span class="kn">import</span> <span class="n">Point</span>

<span class="k">class</span> <span class="nc">Line</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">start</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">end</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">class</span> <span class="nc">AlternativeLine</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">speckle_type</span><span class="o">=</span><span class="s2">&quot;Line_Two&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The `speckle_type` is automatically populated by the class name.</span>
<span class="sd">    You can override this behaviour as demonstrated here.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># look, a new custom line!</span>
<span class="n">line</span> <span class="o">=</span> <span class="n">Line</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># adding dynamic attributes as normal</span>
<span class="n">line</span><span class="o">.</span><span class="n">blah</span> <span class="o">=</span> <span class="s2">&quot;blah&quot;</span>
<span class="n">line</span><span class="p">[</span><span class="s2">&quot;colour&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>You can also mark typed attributes as detachable or chunkable by updating the internal <code class="docutils literal notranslate"><span class="pre">_detachable</span></code> set or <code class="docutils literal notranslate"><span class="pre">_chunkable</span></code> dict with the provided helper methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">specklepy.objects</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>

<span class="c1"># members that are chunked upon sending are stored in a dictionary</span>
<span class="c1"># with the name as the key and the maximum chunk size as the value</span>
<span class="n">CHUNKABLE_PROPS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;vertices&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;faces&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;colors&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;textureCoordinates&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;test_bases&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># detachable members are just added to an internal set by name</span>
<span class="n">DETACHABLE</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;detach_this&quot;</span><span class="p">,</span> <span class="s2">&quot;origin&quot;</span><span class="p">}</span>

<span class="c1"># you can pass a chunkables dict and a detachables as keyword arguments when writing your class</span>
<span class="k">class</span> <span class="nc">FakeMesh</span><span class="p">(</span><span class="n">Base</span><span class="p">,</span> <span class="n">chunkable</span><span class="o">=</span><span class="n">CHUNKABLE_PROPS</span><span class="p">,</span> <span class="n">detachable</span><span class="o">=</span><span class="n">DETACHABLE</span><span class="p">):</span>
    <span class="n">vertices</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">faces</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">colors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">textureCoordinates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">test_bases</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Base</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">detach_this</span><span class="p">:</span> <span class="n">Base</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_origin</span><span class="p">:</span> <span class="n">Point</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># properties are also picked up and serialised as you&#39;d expect</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">origin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_origin</span>

    <span class="nd">@origin</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">origin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Point</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_origin</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="serialization">
<h4>Serialization<a class="headerlink" href="#serialization" title="Permalink to this heading">#</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">BaseObjectSerializer</span></code> is used behind the scenes in the <code class="docutils literal notranslate"><span class="pre">operations</span></code> for decomposing and serializing <code class="docutils literal notranslate"><span class="pre">Base</span></code> objects so they can be sent/received to the server. You probably won’t ever need to use it directly. However, if you want, you can use it to get the id (hash) and a serializable object representation of the decomposed <code class="docutils literal notranslate"><span class="pre">Base</span></code>. You can learn more about the Speckle <code class="docutils literal notranslate"><span class="pre">Base</span></code> object <span class="xref myst">here</span> and the decomposition API <span class="xref myst">here</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">specklepy.objects</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">from</span> <span class="nn">specklepy.serialization.base_object_serializer</span> <span class="kn">import</span> <span class="n">BaseObjectSerializer</span>

<span class="n">detached_base</span> <span class="o">=</span> <span class="n">Base</span><span class="p">()</span>
<span class="n">detached_base</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;a detached base&quot;</span>

<span class="n">base_obj</span> <span class="o">=</span> <span class="n">Base</span><span class="p">()</span>
<span class="n">base_obj</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;my base&quot;</span>
<span class="n">base_obj</span><span class="p">[</span><span class="s2">&quot;@nested&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">detached_base</span>

<span class="n">serializer</span> <span class="o">=</span> <span class="n">BaseObjectSerializer</span><span class="p">()</span>
<span class="nb">hash</span><span class="p">,</span> <span class="n">obj_dict</span> <span class="o">=</span> <span class="n">serializer</span><span class="o">.</span><span class="n">traverse_base</span><span class="p">(</span><span class="n">base_obj</span><span class="p">)</span>

<span class="nb">hash</span><span class="p">,</span> <span class="n">serialized</span> <span class="o">=</span> <span class="n">serializer</span><span class="o">.</span><span class="n">write_json</span><span class="p">(</span><span class="n">base_obj</span><span class="p">)</span>
<span class="n">deserialized</span> <span class="o">=</span> <span class="n">serializer</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">serialized</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sending-receiving">Sending &amp; Receiving</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#short-hand-the-stream-wrapper">Short Hand: The Stream Wrapper</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview-of-functionality">Overview of Functionality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graphql-client">GraphQL Client</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operations-and-transports">Operations and Transports</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#base-object-serialization">Base Object &amp; Serialization</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-base-object">The Base Object</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#subclassing-base">Subclassing Base</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#serialization">Serialization</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Daniel Fink
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>